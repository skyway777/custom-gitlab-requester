!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("ky-universal"),require("form-data"),require("humps"),require("query-string"),require("https"),require("fs")):"function"==typeof define&&define.amd?define(["exports","ky-universal","form-data","humps","query-string","https","fs"],t):t((e=e||self)["node-gitlab"]={},e.Ky,e.FormData,e.Humps,e.QueryString,e.https,e.fs)}(this,function(e,t,r,n,o,a,u){"use strict";t=t&&t.hasOwnProperty("default")?t.default:t,r=r&&r.hasOwnProperty("default")?r.default:r,a=a&&a.hasOwnProperty("default")?a.default:a,u=u&&u.hasOwnProperty("default")?u.default:u;var s=function(){return(s=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function i(e,t,r,n){return new(r||(r=Promise))(function(o,a){function u(e){try{i(n.next(e))}catch(e){a(e)}}function s(e){try{i(n.throw(e))}catch(e){a(e)}}function i(e){e.done?o(e.value):new r(function(t){t(e.value)}).then(u,s)}i((n=n.apply(e,t||[])).next())})}function c(e,t){var r,n,o,a,u={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;u;)try{if(r=1,n&&(o=2&a[0]?n.return:a[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,a[1])).done)return o;switch(n=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return u.label++,{value:a[1],done:!1};case 5:u.label++,n=a[1],a=[0];continue;case 7:a=u.ops.pop(),u.trys.pop();continue;default:if(!(o=(o=u.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){u=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){u.label=a[1];break}if(6===a[0]&&u.label<o[1]){u.label=o[1],o=a;break}if(o&&u.label<o[2]){u.label=o[2],u.ops.push(a);break}o[2]&&u.ops.pop(),u.trys.pop();continue}a=t.call(e,u)}catch(e){a=[6,e],n=0}finally{r=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}function l(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,a=r.call(e),u=[];try{for(;(void 0===t||t-- >0)&&!(n=a.next()).done;)u.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(o)throw o.error}}return u}function f(e,t,r){return/^([A-Z0-9])+_*/.test(e)?e:t(e,r)}var p={};function d(e){var t={};return function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(l(arguments[t]));return e}(e.headers.entries()).forEach(function(e){var r=l(e,2),n=r[0],o=r[1];t[n]=o}),t}function y(e){if(e)try{return u.readFileSync(e)}catch(t){throw"Error while reading file: "+e+". Error "+t}}function h(e,t){var u=t.body,s=t.query,i=t.sudo,c=t.method;console.log("build request");var l=new Headers(e.headers),p=u,d=function(){var e=process.env,t=e.GITLAB_SSL_KEY,r=e.GITLAB_SSL_CERT;if(t||r){console.log("GITLAB_SSL_KEY",t,"GITLAB_SSL_CERT",r);var n=y(t),o=y(r);return new a.Agent({key:n,cert:o})}}();return i&&l.append("sudo",""+i),"object"!=typeof u||u instanceof r||(p=JSON.stringify(n.decamelizeKeys(u,f)),l.append("content-type","application/json")),{timeout:e.requestTimeout,headers:l,method:"stream"===c?"get":c,onProgress:"stream"===c?function(){}:void 0,searchParams:o.stringify(n.decamelizeKeys(s||{}),{arrayFormat:"bracket"}),prefixUrl:e.url,body:p,agent:d}}function v(e){return i(this,void 0,void 0,function(){var t,r;return c(this,function(n){switch(n.label){case 0:return t=e.headers.get("content-type")||"",[4,e.text()];case 1:if(r=n.sent(),t.includes("json"))try{return[2,JSON.parse(r||"{}")]}catch(e){return[2,{}]}return[2,r]}})})}["get","post","put","delete","stream"].forEach(function(e){p[e]=function(r,n,o){return i(this,void 0,void 0,function(){var a,u,i,l,f,p;return c(this,function(c){switch(c.label){case 0:a=h(r,s({},o,{method:e})),c.label=1;case 1:return c.trys.push([1,3,,6]),[4,t(n,a)];case 2:return u=c.sent(),console.log("response: ",u),[3,6];case 3:return(i=c.sent()).response?[4,i.response.json()]:[3,5];case 4:l=c.sent(),i.description=l.error||l.message,c.label=5;case 5:throw i;case 6:return f=u.status,p=d(u),[4,v(u)];case 7:return[2,{body:c.sent(),headers:p,status:f}]}})})}}),e.KyRequester=p,e.skipAllCaps=f,Object.defineProperty(e,"__esModule",{value:!0})});
